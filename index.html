<style>body {
    margin: 0;
    text-align: center;
    background-color: #000;
  }</style><canvas id="c"></canvas><script>function _toArray(e){return Array.isArray(e)?e:Array.from(e)}var _slicedToArray=function(){function e(e,t){var r=[],i=!0,a=!1,n=void 0;try{for(var o,c=e[Symbol.iterator]();!(i=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw n}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(){function e(e,t){return Math.floor(Math.random()*(t+1-e)+e)}function t(t){return t[e(0,t.length-1)]}function r(){for(var t="#",r=0;r<6;r++)t+=e(0,9);return t}function i(){ue=[];for(var e=void 0,r=0;r<R*I;r++)e=0===r?ie+ae:r===R-1?ne+ae:r===R*(I-1)?ie+re:r===R*I-1?ne+re:t(r<R-1?[ne+ie,ne+ae+ie]:R*(I-1)<r?[ne+ie,ne+re+ie]:r%R?r%R==R-1?[re+ae,re+ne+ae]:[ne+re+ie+ae,re+ne+ae,re+ie+ae,ne+re+ie,ne+ae+ie,re+ae,ne+ie,oe]:[re+ae,re+ie+ae]),ue[r]=e}function a(){se=[];for(var e=0;e<R*I;e++){var t=e%R,i=(e-t)/R;ue[e]!==oe?(se.push([t*D,i*D,E,E,r(),e]),se.push([t*D+2*E,i*D,E,E,r(),e]),se.push([t*D,i*D+2*E,E,E,r(),e]),se.push([t*D+2*E,i*D+2*E,E,E,r(),e]),ue[e]&re||se.push([t*D+E,i*D,E,E,r(),e]),ue[e]&ne||se.push([t*D,i*D+E,E,E,r(),e]),ue[e]&ae||se.push([t*D+E,i*D+2*E,E,E,r(),e]),ue[e]&ie||se.push([t*D+2*E,i*D+E,E,E,r(),e])):se.push([t*D+E,i*D+E,E,E,"red",e])}}function n(){L&&(K=requestAnimationFrame(n),s(),G=Date.now(),A((G-H)/1e3),H=G)}function o(e){L=e,L?(H=Date.now(),n()):cancelAnimationFrame(K)}function l(){z.drawImage(W,0,0,P,q,0,0,c.width,c.height)}function s(){switch(T){case x:j.fillStyle="white",j.fillRect(0,0,P,q),f("a Tourist in Paris",P/2,128,"64px Arial"),Math.floor(G/1e3)%2&&f("press N to start",P/2,2*q/3,"24px Arial"),f("proudly made in Canada",P/2,q-2.5*E,"24px Arial"),f("by Jerome Lecomte for JS13KGAMES 2017",P/2,q-E,"24px Arial");break;case k:j.fillStyle="white",j.fillRect(0,0,P,q),f("Tourist: person geographically and culturally",2*E,2*E,"24px Arial","left"),f("lost, trying to cross iconic sightseeings from his",2*E,4*E,"24px Arial","left"),f("bucket list before his tour bus departs.",2*E,6*E,"24px Arial","left"),f("Arrow keys or WASD/ZQSD to move around.",2*E,10*E,"24px Arial","left"),f("Touch all red squares before time runs out.",2*E,12*E,"24px Arial","left"),Math.floor(G/1e3)%2&&f("Press any key.",2*E,16*E,"24px Arial","left");break;case S:j.drawImage(F,N,_,P,q,0,0,P,q),le[B]=r(),u(le),he&&(u(he,J),he=null);var e=Math.floor(Math.ceil(pe)/60),t=Math.ceil(pe)-60*e;f(e+":"+(t<=9?"0":"")+t,P-E,2*E,"24px Arial","right");break;case M:j.fillStyle="white",j.fillRect(0,0,P,q),f("You "+(ge?"won":"lost")+"!",P/2,128),f(de+" out of "+fe+" sightseeings",P/2,q/2),f("press N to start new level",P/2,2*q/3,"24px Arial"),f("press R to retry same level",P/2,2*q/3+2*E,"24px Arial")}l()}function h(){J.fillStyle="white",J.fillRect(0,0,F.width,F.height);var e=!0,t=!1,r=void 0;try{for(var i,a=se[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){u(i.value,J)}}catch(e){t=!0,r=e}finally{try{!e&&a.return&&a.return()}finally{if(t)throw r}}}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j;t.fillStyle=e[B];var r=e[O]-(e===le?N:0),i=e[Q]-(e===le?_:0);t.fillRect(Math.round(r),Math.round(i),e[Y],e[Z])}function f(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"48px Arial",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"center",n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"black";j.fillStyle=n,j.font=i,j.textAlign=a,j.fillText(e,t,r)}function d(e){var t=e*le[te];le[O]+=(le[$]+le[ee])*t,le[Q]+=(le[V]+le[X])*t}function v(e){var t=le[O]+le[Y],r=le[Q]+le[Z],i=e[O]+e[Y],a=e[Q]+e[Z];return[le[O]<i&&t>e[O]&&le[Q]<a&&r>e[Q],t,r,i,a]}function y(e,t){var r=_slicedToArray(t,4),i=r[0],a=r[1],n=r[2],o=r[3],c=i-e[O],l=a-e[Q],s=n-le[O],h=o-le[Q];le[ee]&&le[X]?c<l?le[O]-=c:le[Q]-=l:le[ee]&&le[V]?c<h?le[O]-=c:le[Q]+=h:le[ee]?le[O]-=c:le[$]&&le[X]?s<l?le[O]+=s:le[Q]-=l:le[$]&&le[V]?s<h?le[O]+=s:le[Q]+=h:le[$]?le[O]+=s:le[X]?le[Q]-=l:le[V]&&(le[Q]+=h)}function g(e){ue[e[U]]===oe&&"red"===e[B]&&(e[B]="green",he=e,de++)}function p(){0<N&&le[O]<N+C?N=Math.max(0,le[O]-C):N<F.width-P&&le[O]+le[Y]>N+P-C&&(N=Math.min(F.width-P,le[O]+le[Y]-P+C)),0<_&&le[Q]<_+C?_=Math.max(0,le[Q]-C):_<F.height-q&&le[Q]+le[Z]>_+q-C&&(_=Math.min(F.height-q,le[Q]+le[Z]-q+C))}function w(){de===fe?(T=M,ge=!0):pe<0&&(T=M,ge=!1)}function m(){i(),a(),h(),fe=ue.reduce(function(e,t){return e+(t===oe?1:0)},0),ve=!1,b()}function b(){se.forEach(function(e){ue[e[U]]===oe&&(e[B]="red")}),de=0,N=_=le[V]=le[X]=le[$]=le[ee]=0,le[O]=le[Q]=E,he=null,ge=!1,ye=!1,pe=ce,T=S}function A(e){switch(T){case M:ye&&b();case k:ve&&m();break;case S:pe-=e,d(e);var t=!0,r=!1,i=void 0;try{for(var a,n=se[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){var o=a.value,c=v(o),l=_toArray(c),s=l[0],h=l.slice(1);s&&(y(o,h),g(o))}}catch(e){r=!0,i=e}finally{try{!t&&n.return&&n.return()}finally{if(r)throw i}}p(),w()}}var x=0,k=1,S=2,M=3,T=x,E=20,D=3*E,R=14,I=10,C=100,N=0,_=0,z=c.getContext("2d"),P=600,q=480,F=c.cloneNode(),J=F.getContext("2d"),W=c.cloneNode(),j=W.getContext("2d"),G=void 0,H=void 0,K=void 0,L=!0,O=0,Q=1,Y=2,Z=3,B=4,U=5,V=5,X=6,$=7,ee=8,te=9,re=1,ie=2,ae=4,ne=8,oe=31,ce=60,le=[E,E,10,10,"blue",0,0,0,0,100],se=void 0,he=void 0,ue=void 0,fe=void 0,de=void 0,ve=void 0,ye=void 0,ge=void 0,pe=void 0;onload=function(e){document.title="A Tourist in Paris",F.width=R*D,F.height=I*D,W.width=P,W.height=q,onresize(),o(!0)},document.onvisibilitychanged=function(e){o(!e.target.hidden)},onresize=onrotate=function(){var e=Math.min(innerWidth/P,innerHeight/q);c.width=P*e,c.height=q*e,[z,J,j].forEach(function(e){e.mozImageSmoothingEnabled=e.msImageSmoothingEnabled=e.imageSmoothingEnabled=!1})},onkeydown=function(e){switch(e.preventDefault(),T){case S:switch(e.which){case 37:case 65:case 81:le[$]=-1;break;case 38:case 90:case 87:le[V]=-1;break;case 39:case 68:le[ee]=1;break;case 40:case 83:le[X]=1}}},onkeyup=function(e){switch(e.preventDefault(),T){case x:switch(e.which){case 13:case 78:T=k}break;case k:ve=!0;break;case S:switch(e.which){case 37:case 65:case 81:le[$]=0;break;case 38:case 90:case 87:le[V]=0;break;case 39:case 68:le[ee]=0;break;case 40:case 83:le[X]=0}break;case M:switch(e.which){case 13:case 78:ve=!0;break;case 82:ye=!0}}}}();
//# sourceMappingURL=game.js.map</script>